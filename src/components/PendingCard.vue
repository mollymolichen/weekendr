<template>
<v-content class="pendingcard">
    <v-card class="pending">
        <v-layout column wrap id="center">
            <!--Profile picture-->
            <v-flex xs3>
                <router-link :to="{ name: 'Profile', params: { user: guest, myProfile } }">
                    <v-avatar class="profile-avatar">
                        <img :src="guest.propicUrl" alt="Profile picture">
                    </v-avatar><br>
                </router-link>
                        <h1>{{guest.firstName}}, {{guest.age}}</h1>
                        <h2>{{guest.universityOrOccupation}}</h2>
            </v-flex>

            <!--Events they're pending for-->
            <v-flex xs4 id="pink" color="pink lighten-5">
                <h2>Responded to:</h2>
                <h2><strong>{{event.title}}</strong></h2>
                <h2>{{event.dateFormatted}}, {{event.time.startTime}} - {{event.time.endTime}}</h2>
            </v-flex>

            <div id="icons">
                <v-icon @click="changeGuestStatus(guest.uuid, true)">done_outline</v-icon>
                <v-icon @click="changeGuestStatus(guest.uuid, false)">block</v-icon>
            </div>
        </v-layout>
    </v-card>
</v-content>
</template>

<script>
/* eslint-disable */
import {
    eventsRef
} from "../database.js";
import Profile from "./Profile";
import EventPreview from "./EventPreview";

export default {
    data() {
        return {
            view: false,
            events: [],
            attendingHostEvent: [], // specific to one host at a time
        }
    },
    components: {
        EventPreview,
        Profile
    },
    firebase: {
        eventsRef
    },
    props: ['guest', 'event', 'attendees'],
    methods: {
        async changeGuestStatus(guestID, approveGuest) {    // TODO: make card disappear right after change status
            // remove from interested
            let i = this.event.interested.indexOf(guestID);
            this.event.interested.splice(i, 1);             // removing everyone, not just one
            await eventsRef.child(this.event.eid).update({
                interested: this.event.interested
            });

            // either approve or remove to confirmed
            if (approveGuest) {
                this.event.confirmed.push(guestID);
                await eventsRef.child(this.event.eid).update({
                    confirmed: this.event.confirmed
                });
            }
        }
    },
    mounted() {

    }
}
</script>

<style>
.pendingcard {
    display: flex;
    margin: 20px 20px 0px 20px;
}

.pending {
    background-color: aliceblue !important;
    display: flex;
    flex-direction: column;
    border-radius: 25px;
}

#center {
    align-items: center;
}

#pink {
    background-color: #fce4ec;
    margin: 20px 20px 20px 20px;
    padding: 15px;
    border-radius: 25px;
}

#icons {
    display: flex;
    margin: 10px 0px 20px 0px;
}

.profile-avatar {
    display: flex;
    margin: 70px 30px 30px 50px;
    transform: scale(1.3, 1.3);
    height: 150px !important;
    width: 150px !important;
}
</style>
